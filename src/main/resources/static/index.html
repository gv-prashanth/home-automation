<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>My Droid Dashboard</title>
<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
<script>
function loadHomeName(){
document.getElementById("homeName").value = localStorage.getItem("homename");
}
function loadDoc() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
        	try{
	        	var myjson = JSON.parse(this.responseText);
	            let tableHtml = '<table border=2 style="text-align: center; vertical-align: middle; width: 50%;"><tr><th>Device</th><th>Reading</th></tr>';
	            for (const key in myjson){
	            	tableHtml += '<tr><td>'+key+'</td><td>'+myjson[key]+'</td></tr>';
	            }
	            tableHtml += '</table>';
	            document.getElementById("resp").innerHTML = tableHtml;
	            localStorage.setItem("homename", document.getElementById("homeName").value);
            }catch(err){
				document.getElementById("resp").innerHTML = '';
            }
       }
    };
    if(document.getElementById("homeName").value!=''){
	    xhttp.open("GET", '/home/'+document.getElementById("homeName").value+'/intents', true);
	    xhttp.send();
    }else{
    	document.getElementById("resp").innerHTML = '';
    }
}
setInterval(function() {
    loadDoc();
}, 5000);
</script>
<style>
body {
  background-image: url('/images/background.jpg');
  background-repeat: no-repeat;
  background-attachment: fixed; 
  background-size: 100% 100%;
}
input {
height: 30px; width: 250px; font-size: 16px;
}
</style>
</head>
<body onload="loadHomeName();loadDoc();">
	<center>
		<img src="/images/HomeDroid2Small.png"/>
		<h1>My Droid Dashboard</h1>
		<input type="text" id="homeName" placeholder="Please enter your home name"/>
		<h2 id="resp"></h2>
	</center>
</body>
</html>